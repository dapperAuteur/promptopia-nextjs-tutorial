(()=>{"use strict";const e="aryel-embed",t="aryel-embed-viewer",n="aryel-embed-ui-loader",r="aryel-embed-ui-gestures",i="aryel-embed-ui-badge",a="aryel-embed-ui-button",s="aryel-embed-global-style",o=`${n}-style`,l=`${r}-style`,u=`${i}-style`,d=`${a}-style`,c="aryel-embed-button",m={color:{value:"#fc1aa0",type:"color"}},h={"min-zoom":{value:0,type:"float"},"max-zoom":{value:5,type:"float"},"auto-rotate":{value:0,type:"int"},pan:{value:!0,type:"boolean"},zoom:{value:!0,type:"boolean"},rotate:{value:!0,type:"boolean"},damping:{value:!0,type:"boolean"},helper:{value:!0,type:"boolean"}},b={text:{value:"View in AR",type:"string"},return:{value:!1,type:"boolean"}},p=(e,t)=>{console.warn(`Aryel embed - ${e}`)},y=e=>/^#[0-9A-F]{6}$/i.test(e)||/^#([0-9A-F]{3}){1,2}$/i.test(e),g=(e,t,n)=>{var r;const i=JSON.parse(JSON.stringify(n));if(!t)return i;let a=null;try{a=(e=>{let t={},n=[],r=e;";"===r.charAt(r.length-1)&&(r=r.slice(0,r.length-1)),n=r.split(";");for(let e of n)"src:"===e.trim().slice(0,4)?t.src=e.replace("src:","").trim():t[e.split(":")[0].trim()]=e.split(":")[1].trim();return t})(t)}catch(t){return p(`An error occured while parsing ${e} properties. Default values will be used`),i}if(!a)return i;try{for(let t of Object.keys(i))if(a[t])switch(i[t].type){case"string":i[t].value=a[t];break;case"boolean":i[t].value="true"===a[t];break;case"color":y(a[t])?i[t].value=a[t]:p(`${e} ${t} color is written wrong. Expected hex color. Will be converted to "${i[t].value}"`);break;case"float":i[t].value=parseFloat(a[t]);break;case"int":i[t].value=parseInt(a[t]);break;case"enum":if(!(null===(r=i[t].enums)||void 0===r?void 0:r.length))break;if(!i[t].enums.includes(a[t])){p(`${e} ${t} value "${a[t]}" is not a permitted value. Permitted values are ${i[t].enums.join(", ")}.`);break}i[t].value=a[t];break;case"vector":const n=a[t].split(" ");if(3!==n.length){p('camera position is not written correctly. Expected value "x y z". Will be converted to "0 0 30"');break}i[t].value={x:parseFloat(n[0]),y:parseFloat(n[1]),z:parseFloat(n[2])}}}catch(t){return p(`An error occured while parsing ${e} properties. Default values will be used`),i}return i};class f extends HTMLElement{constructor(){super()}connectedCallback(){this.addStyle(),this.addBody(),this.onConnect()}onConnect(){}addStyle(){if(!document.querySelector(`[${this.styleSelector}]`)){const e=document.createElement("style");e.innerHTML=this.uiStyle.replace(/\s+/g," ").trim(),e.setAttribute(this.styleSelector,""),document.head.appendChild(e)}}addBody(){this.innerHTML=this.uiBody}}var v=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function s(e){try{l(r.next(e))}catch(e){a(e)}}function o(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}l((r=r.apply(e,t||[])).next())}))};class w extends HTMLElement{constructor(){super(),this.campaignData=null}get loader(){return this.querySelector(n)}get gesturesHelper(){return this.querySelector(r)}connectedCallback(){return v(this,void 0,void 0,(function*(){yield customElements.whenDefined(n),yield customElements.whenDefined(r),this.addStyle();const i=document.querySelector("[aryel-embed-loader]");if(!i)return p("an error occured while initializating the 3D viewer");if(document.querySelectorAll("[aryel-embed-loader]").length>1)return p("there is more than one embed viewer script. Check your implementation");const a=new URL(i.getAttribute("src"));if(!a)return p("an error occured while initializating the 3D viewer");const s=a.searchParams.get("apiKey");if(!s)return p("missing api key or an error occured while retriving the api key");const o=this.getAttribute("campaign");if(!o)return p("missing campaign id");if(a.searchParams.get("v")&&"2"===a.searchParams.get("v")){this.addLoader(),this.addGesturesHelper();const t=Array.from(document.querySelectorAll(e)).filter((e=>e.getAttribute("campaign")===o));t.length>1?t[0].campaignData?(this.campaignData=t[0].campaignData,this.startViewer()):t[0].addEventListener("onData",(e=>{const t=e.target;t.campaignData&&(this.campaignData=t.campaignData,this.startViewer())})):fetch(`https://app.aryel.io/api/v1/campaigns/${o}?api-key=${s}&embed=3d`).then((e=>e.json())).then((e=>v(this,void 0,void 0,(function*(){if(!e.asset||!e.campaign_url)return t="Cant't find campaign asset or url",void console.error(`Aryel embed - ${t}`);var t;this.campaignData=e,this.dispatchEvent(new Event("onData")),this.startViewer()})))).catch((e=>p("an error occured while fetching campaign data")))}else{this.addScript(!1),this.hasAttribute("background")&&(y(this.getAttribute("background"))?this.style.backgroundColor=this.getAttribute("background"):p("embed viewer background color is not a valid hex color.")),yield customElements.whenDefined(t);const e=document.createElement(t);for(let t of this.attributes)e.setAttribute(t.name,t.value);e.setAttribute("api-key",s),this.appendChild(e)}}))}startViewer(){return v(this,void 0,void 0,(function*(){this.addBadge(),this.addButton();const e=new URL(document.querySelector("[aryel-embed-loader]").getAttribute("src"));this.addScript(e.searchParams.get("v")&&"2"===e.searchParams.get("v")),this.addBackground(),yield customElements.whenDefined(t);const n=document.createElement(t),r=["campaign","loader","button","button-style","background"];for(let e of this.attributes)r.includes(e.name)||n.setAttribute(e.name,e.value);this.appendChild(n),n.addEventListener("onReady",this.onViewerReady.bind(this)),n.addEventListener("onInteraction",this.onViewerInteraction.bind(this)),n.initialize(this.campaignData)}))}addScript(e=!1){if(document.head.querySelector("[aryel-embed-script]"))return;const t=document.createElement("script");t.src=e?"https://assets.aryel.io/embed-viewer/aryel-viewer-v2.js":"https://assets.aryel.io/embed-viewer/aryel-viewer.js",t.setAttribute("aryel-embed-script",""),document.head.appendChild(t)}addStyle(){if(!document.querySelector(`[${s}]`)){const e=document.createElement("style");e.innerHTML=`\n        aryel-embed {\n          display: block;\n          width: 100%;\n          height: 100%;\n          position: relative;\n          font-family: inherit;\n        }\n\n        aryel-embed > * {\n          display: none;\n        }\n\n        aryel-embed > ${t},\n        aryel-embed > ${n},\n        aryel-embed > ${r},\n        aryel-embed > ${i},\n        aryel-embed > ${a},\n        aryel-embed > [${c}] {\n          display: block;\n        }\n      `.replace(/\s+/g," ").trim(),e.setAttribute(s,""),document.head.appendChild(e)}}addButton(){const e=this.campaignData.campaign_url,t=Array.from(this.children).find((e=>e.hasAttribute(c)));if(t){const n=g(c,t.getAttribute(c),b);return void("A"===t.nodeName?n.return.value?(t.setAttribute("href",`${e}?go-back=true`),t.setAttribute("target","_self")):(t.setAttribute("href",e),t.setAttribute("target","_blank")):t.addEventListener("click",(()=>{n.return.value?window.open(`${e}?go-back=true`,"_self"):window.open(e,"_blank")})))}if(!this.hasAttribute("button"))return;const n=g("button",this.getAttribute("button"),b),r=document.createElement(a);r.setAttribute("text",n.text.value),n.return.value?(r.setAttribute("url",`${e}?go-back=true`),r.setAttribute("target","_self")):(r.setAttribute("url",e),r.setAttribute("target","_blank")),this.hasAttribute("button-style")&&r.setAttribute("button-style",this.getAttribute("button-style")),this.appendChild(r)}addBackground(){this.hasAttribute("background")&&(y(this.getAttribute("background"))?this.style.backgroundColor=this.getAttribute("background"):p("background color is not a valid hex color."))}addLoader(){const e=document.createElement(n),t=g("loader",this.getAttribute("loader"),m);return e.setAttribute("color",t.color.value),this.appendChild(e),e}onViewerReady(){this.loader.hide(),setTimeout((()=>{this.gesturesHelper&&this.gesturesHelper.show()}),1e3)}onViewerInteraction(){this.gesturesHelper&&this.gesturesHelper.hide()}addBadge(){if(this.campaignData.remove_powered_by)return;const e=document.createElement(i);this.appendChild(e);const t=e=>{"none"===getComputedStyle(e).display&&(e.style.display="block")},n=e=>{"1"!==getComputedStyle(e).opacity&&(e.style.opacity="1")},r=(()=>{const e=this.querySelector(i);if(!this.querySelector(i))return this.appendChild(document.createElement(i));t(e),n(e);const r=this.querySelector(`${i} > img`);if(!r){this.querySelector(i).remove();const e=document.createElement(i);return this.appendChild(e)}t(r),n(r)}).bind(this);setInterval(r,1e3)}addGesturesHelper(){const e=g("gestures",this.getAttribute("gestures"),h);if(!e.helper.value)return;if(!(e.pan.value||e.zoom.value||e.rotate.value||e.damping.value))return null;const t=document.createElement(r);return this.appendChild(t),t}}customElements.define(e,w),customElements.define(n,class extends f{constructor(){super(),this.styleSelector=o}get uiBody(){return'\n      <div class="aryel-embed-ui-loader">\n        <svg\n          viewBox="0 0 66 66"\n          xmlns="http://www.w3.org/2000/svg"\n        >\n          <circle\n            class="circle"\n            fill="none"\n            stroke-width="6"\n            stroke-linecap="round"\n            cx="33"\n            cy="33"\n            r="30"\n          ></circle>\n        </svg>\n      </div>\n    '}get uiStyle(){return"\n      @keyframes rotation {\n        0% {\n          transform: rotate(0deg);\n        }\n        100% {\n          transform: rotate(360deg);\n        }\n      }\n      \n      @-webkit-keyframes rotation {\n        0% {\n          -webkit-transform: rotate(0deg);\n        }\n        100% {\n          -webkit-transform: rotate(360deg);\n        }\n      }\n      \n      @keyframes turn {\n        0% {\n          stroke-dashoffset: 185;\n          transform: rotate(0deg);\n        }\n        50% {\n          stroke-dashoffset: 45;\n          transform: rotate(180deg);\n        }\n        100% {\n          stroke-dashoffset: 185;\n          transform: rotate(360deg);\n        }\n      }\n      \n      @-webkit-keyframes turn {\n        0% {\n          stroke-dashoffset: 185;\n          -webkit-transform: rotate(0deg);\n        }\n        50% {\n          stroke-dashoffset: 45;\n          -webkit-transform: rotate(180deg);\n        }\n        100% {\n          stroke-dashoffset: 185;\n          -webkit-transform: rotate(360deg);\n        }\n      }\n      \n      .aryel-embed-ui-loader {\n        height: 60px;\n        width: 60px;\n        position: absolute;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        margin: auto;\n        z-index: 1;\n        cursor: default;\n        pointer-events: none;\n        transition: opacity .35s;\n        -webkit-transition: opacity .35s;\n      }\n      \n      .aryel-embed-ui-loader.aryel-embed-ui-loader--hide {\n        opacity: 0;\n      }\n      \n      .aryel-embed-ui-loader svg {\n        -webkit-animation: rotation 1.35s linear infinite;\n        animation: rotation 1.35s linear infinite;\n        stroke: #fc1aa0;\n        position: absolute;\n        height: 100%;\n        width: 100%;\n        z-index: 1;\n        top: 0;\n        right: 0;\n        bottom: 0;\n        left: 0;\n        margin: auto;\n      }\n\n      .aryel-embed-ui-loader svg circle {\n        stroke-dasharray: 180;\n        stroke-dashoffset: 0;\n        -webkit-transform-origin: center;\n        -ms-transform-origin: center;\n        transform-origin: center;\n        -webkit-animation: turn 1.35s ease-in-out infinite;\n        animation: turn 1.35s ease-in-out infinite;\n      }\n    "}onConnect(){if(this.hasAttribute("color")){this.querySelector(".aryel-embed-ui-loader svg").style.stroke=this.getAttribute("color")}}hide(){this.querySelector(".aryel-embed-ui-loader").classList.add("aryel-embed-ui-loader--hide"),setTimeout((()=>this.remove()),351)}}),customElements.define(r,class extends f{constructor(){super(),this.styleSelector=l}get uiBody(){return'\n      <div class="aryel-embed-ui-gestures-helper aryel-embed-ui-gestures-helper--hide">\n        <svg xmlns="http://www.w3.org/2000/svg" width="27.92" height="40.2" viewBox="0 0 27.92 40.2">\n          <path id="touch_app_FILL1_wght300_GRAD-25_opsz48" d="M19,18.15a9.065,9.065,0,0,1-2.9-2.95,7.343,7.343,0,0,1-1.05-3.85,7.944,7.944,0,0,1,2.375-5.8A7.82,7.82,0,0,1,23.2,3.15a7.844,7.844,0,0,1,5.75,2.4,7.9,7.9,0,0,1,2.4,5.8,7.886,7.886,0,0,1-1.025,3.925A7.358,7.358,0,0,1,27.4,18.15v-6.3A3.906,3.906,0,0,0,26.2,8.9a4.165,4.165,0,0,0-3-1.15A4.143,4.143,0,0,0,20.175,8.9,3.949,3.949,0,0,0,19,11.85Zm3.35,24.7a4.128,4.128,0,0,1-1.475-.275A2.959,2.959,0,0,1,19.7,41.8l-8.35-8.05a1.5,1.5,0,0,1-.5-1.05,1.694,1.694,0,0,1,.25-1.1,1.261,1.261,0,0,1,.875-.55,4.4,4.4,0,0,1,1.325,0l7.1,1.3V11.95a2.847,2.847,0,0,1,.775-2.025A2.65,2.65,0,0,1,23.2,9.1a2.817,2.817,0,0,1,2.85,2.85V23.2h.9a6.952,6.952,0,0,1,1.35.15,6.255,6.255,0,0,1,1.4.45L36,26.65a3.481,3.481,0,0,1,1.95,2,5.618,5.618,0,0,1,.2,3l-1.65,8.6a3.085,3.085,0,0,1-1.175,1.9,3.427,3.427,0,0,1-2.125.7Z" transform="translate(-10.593 -2.9)" fill="#fff" stroke="#000" stroke-width="0.5"/>\n        </svg>\n      </div>\n    '}get uiStyle(){return"\n      @keyframes gestures-move {\n        0%, 30% {\n          transform: translateX(0%);\n          opacity: 0;\n        }\n        40% {\n          transform: translateX(0%);\n          opacity: 1;\n        }\n        55% {\n          opacity: 1;\n          transform: translateX(-100%);\n        }\n        75%{\n          opacity: 1;\n          transform: translateX(100%);\n        }\n        85% {\n          transform: translateX(0%);\n          opacity: 1;\n        }\n        95%, 100% {\n          opacity: 0;\n        }\n      }\n      \n      @-webkit-keyframes gestures-move {\n          0%, 30% {\n            -webkit-transform: translateX(0%);\n            opacity: 0;\n          }\n          40% {\n            -webkit-transform: translateX(0%);\n            opacity: 1;\n          }\n          55% {\n            opacity: 1;\n            -webkit-transform: translateX(-100%);\n          }\n          75%{\n            opacity: 1;\n            -webkit-transform: translateX(100%);\n          }\n          85% {\n            -webkit-transform: translateX(0%);\n            opacity: 1;\n          }\n          95%, 100% {\n            opacity: 0;\n          }\n      }\n\n      .aryel-embed-ui-gestures-helper {\n        z-index: 1;\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        pointer-events: none;\n        background-color: rgba(0, 0, 0, 0.4);\n        transition: opacity .35s;\n      }\n      \n      .aryel-embed-ui-gestures-helper svg {\n        opacity: 0;\n        position: absolute;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        margin: auto;\n        height: 40px;\n        width: 40px;\n        animation-name: gestures-move;\n        animation-timing-function: ease-in-out;\n        animation-iteration-count: infinite;\n        animation-delay: -0.5s;\n        animation-duration: 6s;\n      }\n      .aryel-embed-ui-gestures-helper.aryel-embed-ui-gestures-helper--hide {\n        opacity: 0;\n      }\n    "}show(){this.querySelector(".aryel-embed-ui-gestures-helper").classList.remove("aryel-embed-ui-gestures-helper--hide")}hide(){const e=this.querySelector(".aryel-embed-ui-gestures-helper");e.classList.contains("aryel-embed-ui-gestures-helper--hide")||(e.classList.add("aryel-embed-ui-gestures-helper--hide"),setTimeout((()=>this.remove()),351))}}),customElements.define(i,class extends f{constructor(){super(),this.styleSelector=u}get uiBody(){return'\n      <img\n        src="https://assets.aryel.io/embed-viewer/powered-by-aryel.svg"\n        alt="Powered by Aryel"\n        class="aryel-embed-ui-badge"\n      />\n    '}get uiStyle(){return"\n      .aryel-embed-ui-badge{\n        position: absolute;\n        top: 0.75rem;\n        left: 0;\n        right: 0;\n        margin: auto;\n        width: 80%;\n        text-align: center;\n        max-width: 8rem;\n      }\n    "}}),customElements.define(a,class extends f{constructor(){super(),this.customStyle="",this.styleSelector=d}get uiBody(){return`\n      <div class="aryel-embed-ui-button">\n        <a\n          href="${this.getAttribute("url")}"\n          target="${this.getAttribute("target")}"\n        >\n          ${this.getAttribute("text")}\n        </a>\n      </div>\n    `}get uiStyle(){return"\n    .aryel-embed-ui-button {\n      position: absolute;\n      bottom: 0;\n      left: 0;\n      width: 100%;\n      text-align: center;\n      pointer-events: none;\n      cursor: default;\n      font-family: inherit;\n    }\n    .aryel-embed-ui-button-default a {\n      color: #fff;\n      border: none;\n      box-shadow: none;\n      outline: none;\n      position: relative;\n      z-index: 1;\n      overflow: hidden;\n      cursor: pointer;\n      pointer-events: all;\n      padding: 16px 35px;\n      border-radius: 21.25px;\n      z-index: 1;\n      letter-spacing: 0;\n      font-size: 18px;\n      font-weight: bold;\n      line-height: 0.9rem;\n      background: linear-gradient(315deg, #ff00cf 0%, #d800da 100%);\n      display: inline-block;\n      font-family: inherit;\n      text-decoration: none;\n    }\n    "}onConnect(){if(!this.hasAttribute("button-style"))return this.querySelector(".aryel-embed-ui-button").classList.add("aryel-embed-ui-button-default");this.querySelector("a").setAttribute("style",`cursor: pointer; pointer-events: all; ${this.getAttribute("button-style")}`)}})})();